{"ast":null,"code":"var _jsxFileName = \"C:\\\\D\\\\AI_role\\\\Accompany_women\\\\frontend\\\\src\\\\pages\\\\Chat.tsx\";\nimport React, { useState, useRef, useEffect } from 'react';\nimport { useParams } from 'react-router-dom';\nimport { Box, Paper, TextField, IconButton, Typography, keyframes, createTheme, ThemeProvider, Collapse, CircularProgress, Menu, ListItemIcon, ListItemText, Dialog, DialogTitle, DialogContent, Grid, Switch, Slider, Divider, List, ListItem, ListSubheader } from '@mui/material';\nimport { Send as SendIcon, Mic as MicIcon, Menu as MenuIcon, VolumeUp as VolumeUpIcon, ExpandMore as ExpandMoreIcon, ExpandLess as ExpandLessIcon, MusicNote as MusicNoteIcon, PlayArrow as PlayArrowIcon, Call as CallIcon, Person as PersonIcon, Wallpaper as WallpaperIcon, PlayCircle as PlayCircleIcon } from '@mui/icons-material';\n\n// 定义深色主题\nconst darkTheme = createTheme({\n  palette: {\n    mode: 'dark',\n    background: {\n      default: '#000000',\n      paper: 'rgba(32, 32, 32, 0.8)'\n    },\n    text: {\n      primary: '#ffffff',\n      secondary: 'rgba(255, 255, 255, 0.7)'\n    }\n  }\n});\n\n// 定义气泡动画\nconst bubbleAppear = keyframes`\n  0% {\n    opacity: 0;\n    transform: translateY(10px);\n  }\n  100% {\n    opacity: 1;\n    transform: translateY(0);\n  }\n`;\nconst Chat = () => {\n  const {\n    characterId\n  } = useParams();\n  const [showMessages, setShowMessages] = useState(true);\n  const [isIntroExpanded, setIsIntroExpanded] = useState(false);\n  const [isPlaying, setIsPlaying] = useState(null);\n  const [isMusicEnabled, setIsMusicEnabled] = useState(true);\n  const [characterInfo] = useState({\n    id: '1',\n    name: '罗峻雪',\n    avatar: '/images/characters/ceo.jpg',\n    introduction: '极为顽劣的财阀小少爷,少年细腰,雪发花眸,有一半的日耳曼血统,小名schlanke Schöne.(细腰美人)',\n    backgroundStory: '一度想把自己的名字改为罗素腰,但是被母亲强烈反对...',\n    height: '188cm',\n    age: 27,\n    connections: 794000,\n    openingMessage: {\n      content: '你这个可爱的小野猫',\n      sceneDescription: '（纸醉金迷,素手执杯,纸牌骰子,冰冷的珠宝映着富贵浮华的颜色,水蛇般的身躯慵懒倚靠）',\n      actionDescription: '（少年半靠在沙发里，身边簇拥着一群男生，有人喝酒有人递烟，他低着头把玩着长链手机，睫毛颤颤的，樱花色的薄唇被酒液浸润，透着一股无辜的艳色）'\n    }\n  });\n  const [messages, setMessages] = useState([]);\n  const [inputMessage, setInputMessage] = useState('');\n  const [isVoiceEnabled, setIsVoiceEnabled] = useState(true);\n  const messagesEndRef = useRef(null);\n  const characterImageRef = useRef(null);\n  const [playingMessageId, setPlayingMessageId] = useState(null);\n  const messagesContainerRef = useRef(null);\n  const [isNearBottom, setIsNearBottom] = useState(true);\n  const [isUserScrolling, setIsUserScrolling] = useState(false);\n  const userScrollTimeoutRef = useRef();\n  const [isVoicePlaying, setIsVoicePlaying] = useState(false);\n  const [anchorEl, setAnchorEl] = useState(null);\n  const [isBackgroundDialogOpen, setIsBackgroundDialogOpen] = useState(false);\n  const [autoPlayVoice, setAutoPlayVoice] = useState(false);\n  const [backgroundMusicVolume, setBackgroundMusicVolume] = useState(50);\n  const [voiceSettings, setVoiceSettings] = useState({\n    dialogue: true,\n    thoughts: false,\n    narration: false\n  });\n  const [nickname, setNickname] = useState('');\n  const [isEditingNickname, setIsEditingNickname] = useState(false);\n  const nicknameInputRef = useRef(null);\n  const [voiceConfig] = useState({\n    dialogueVoice: 'voice1',\n    // 示例声音配置\n    narrationVoice: 'voice2',\n    thoughtsVolumeReduction: 3 // 降低3分贝\n  });\n  const checkIfNearBottom = () => {\n    const container = messagesContainerRef.current;\n    if (container) {\n      const {\n        scrollHeight,\n        scrollTop,\n        clientHeight\n      } = container;\n      const distanceFromBottom = scrollHeight - scrollTop - clientHeight;\n      setIsNearBottom(distanceFromBottom < 500);\n    }\n  };\n  const handleUserScroll = () => {\n    setIsUserScrolling(true);\n\n    // Clear any existing timeout\n    if (userScrollTimeoutRef.current) {\n      clearTimeout(userScrollTimeoutRef.current);\n    }\n\n    // Reset the user scrolling state after 150ms of no scroll events\n    userScrollTimeoutRef.current = setTimeout(() => {\n      setIsUserScrolling(false);\n    }, 150);\n    checkIfNearBottom();\n  };\n  const scrollToBottom = () => {\n    // 只有在不是播放语音的情况下，且在底部500px范围内时才自动滚动\n    if (isNearBottom && !isVoicePlaying) {\n      var _messagesEndRef$curre;\n      (_messagesEndRef$curre = messagesEndRef.current) === null || _messagesEndRef$curre === void 0 ? void 0 : _messagesEndRef$curre.scrollIntoView({\n        behavior: 'smooth'\n      });\n    }\n  };\n\n  // 监听消息区域的滚动事件\n  useEffect(() => {\n    const container = messagesContainerRef.current;\n    if (container) {\n      container.addEventListener('scroll', handleUserScroll);\n      return () => {\n        container.removeEventListener('scroll', handleUserScroll);\n        if (userScrollTimeoutRef.current) {\n          clearTimeout(userScrollTimeoutRef.current);\n        }\n      };\n    }\n  }, []);\n\n  // 监听消息变化\n  useEffect(() => {\n    if (messages.length > 0) {\n      const lastMessage = messages[messages.length - 1];\n      // 只在新消息（非语音状态更新）时检查是否需要滚动\n      if (!lastMessage.isVoiceLoading) {\n        scrollToBottom();\n      }\n    }\n  }, [messages, isNearBottom]);\n  useEffect(() => {\n    // Add opening message and example responses when component mounts\n    setMessages([{\n      id: 1,\n      narration: [\"纸醉金迷，素手执杯，纸牌骰子，冰冷的珠宝映着富贵浮华的颜色，水蛇般的身躯慵懒倚靠\", \"少年半靠在沙发里，身边簇拥着一群男生，有人喝酒有人递烟，他低着头把玩着长链手机，睫毛颤颤的，樱花色的薄唇被酒液浸润，透着一股无辜的艳色\"],\n      dialogue: \"你这个可爱的小野猫\",\n      sender: 'character',\n      timestamp: new Date()\n    }, {\n      id: 2,\n      content: \"你好呀~\",\n      sender: 'user',\n      timestamp: new Date()\n    }, {\n      id: 3,\n      narration: [\"抬起头来，露出一个慵懒而迷人的微笑，手指轻轻敲击着高脚杯\", \"将手机放在一旁，示意身边的人群稍稍退开，为你留出一个位置\"],\n      dialogue: \"哦？这不是我们可爱的小客人吗\",\n      sender: 'character',\n      timestamp: new Date()\n    }, {\n      id: 4,\n      content: \"我可以坐在这里吗？\",\n      sender: 'user',\n      timestamp: new Date()\n    }, {\n      id: 5,\n      narration: [\"水晶吊灯的光芒在他银色的发丝间流转，映照出一片梦幻般的光晕\", \"优雅地挪了挪位置，修长的手指轻拍身边的沙发座位，嘴角勾起一抹意味深长的笑\"],\n      dialogue: \"当然可以，我可爱的小猫咪。这个位置，我可是特意为你留的呢\",\n      thoughts: \"真是个有趣的小家伙\",\n      sender: 'character',\n      timestamp: new Date()\n    }]);\n  }, [characterInfo]);\n  const handleKeyPress = event => {\n    if (event.key === 'Enter' && !event.shiftKey) {\n      event.preventDefault();\n      handleSendMessage();\n    }\n  };\n  const handleSendMessage = () => {\n    const messageContent = inputMessage.trim() || \"继续\";\n    const newMessage = {\n      id: Date.now(),\n      content: messageContent,\n      sender: 'user',\n      timestamp: new Date()\n    };\n    setIsVoicePlaying(false);\n    setMessages(prev => [...prev, newMessage]);\n    setInputMessage('');\n\n    // 模拟AI回复\n    setTimeout(() => {\n      const aiResponse = {\n        id: Date.now(),\n        narration: [\"轻轻地笑了笑\", \"优雅地端起酒杯，轻轻摇晃\"],\n        dialogue: \"这是AI的回复消息\",\n        thoughts: \"希望能和你聊得开心\",\n        sender: 'character',\n        timestamp: new Date()\n      };\n      setMessages(prev => [...prev, aiResponse]);\n    }, 1000);\n  };\n\n  // 获取要播放的文本内容\n  const getVoiceContent = message => {\n    const content = [];\n    if (voiceSettings.dialogue && message.dialogue) {\n      content.push({\n        text: message.dialogue,\n        voiceType: 'dialogue'\n      });\n    }\n    if (voiceSettings.thoughts && message.thoughts) {\n      content.push({\n        text: message.thoughts,\n        voiceType: 'thoughts'\n      });\n    }\n    if (voiceSettings.narration && message.narration) {\n      message.narration.forEach(text => {\n        content.push({\n          text,\n          voiceType: 'narration'\n        });\n      });\n    }\n    return content;\n  };\n\n  // 播放语音的函数\n  const playVoiceContent = async content => {\n    for (const item of content) {\n      try {\n        // 这里是语音合成的模拟，实际实现时需要替换为真实的语音合成API调用\n        console.log(`Playing ${item.voiceType}:`, item.text);\n        console.log('Voice settings:', {\n          voice: item.voiceType === 'dialogue' ? voiceConfig.dialogueVoice : item.voiceType === 'narration' ? voiceConfig.narrationVoice : voiceConfig.dialogueVoice,\n          // 心声使用对话声音\n          volume: item.voiceType === 'thoughts' ? `Reduced by ${voiceConfig.thoughtsVolumeReduction}db` : 'Normal volume'\n        });\n        await new Promise(resolve => setTimeout(resolve, 2000)); // 模拟语音播放时间\n      } catch (error) {\n        console.error('语音合成失败:', error);\n      }\n    }\n  };\n  const handlePlayVoice = async messageId => {\n    setIsVoicePlaying(true);\n    if (playingMessageId === messageId) {\n      setPlayingMessageId(null);\n      setIsVoicePlaying(false);\n      // TODO: 停止语音播放的逻辑\n      return;\n    }\n    const currentMessage = messages.find(msg => msg.id === messageId);\n    if (!currentMessage || (currentMessage === null || currentMessage === void 0 ? void 0 : currentMessage.isVoiceLoading)) {\n      return;\n    }\n    setMessages(prevMessages => prevMessages.map(msg => msg.id === messageId ? {\n      ...msg,\n      isVoiceLoading: true\n    } : msg));\n    try {\n      const voiceContent = getVoiceContent(currentMessage);\n      if (voiceContent.length === 0) {\n        console.log('没有需要播放的语音内容');\n        return;\n      }\n      await playVoiceContent(voiceContent);\n      setMessages(prevMessages => prevMessages.map(msg => msg.id === messageId ? {\n        ...msg,\n        isVoiceLoading: false\n      } : msg));\n      setPlayingMessageId(messageId);\n\n      // 播放完成后重置状态\n      setTimeout(() => {\n        setPlayingMessageId(null);\n        setIsVoicePlaying(false);\n      }, 1000);\n    } catch (error) {\n      console.error('语音播放失败:', error);\n      setMessages(prevMessages => prevMessages.map(msg => msg.id === messageId ? {\n        ...msg,\n        isVoiceLoading: false\n      } : msg));\n      setPlayingMessageId(null);\n      setIsVoicePlaying(false);\n    }\n  };\n\n  // 自动播放新消息的语音\n  useEffect(() => {\n    if (autoPlayVoice && messages.length > 0) {\n      const lastMessage = messages[messages.length - 1];\n      if (lastMessage.sender === 'character' && !lastMessage.isVoiceLoading) {\n        handlePlayVoice(lastMessage.id);\n      }\n    }\n  }, [messages, autoPlayVoice]);\n\n  // 截断文本的函数\n  const truncateText = (text, maxLength) => {\n    if (text.length <= maxLength) return text;\n    return text.slice(0, maxLength) + '...';\n  };\n  const handleMenuClick = event => {\n    setAnchorEl(event.currentTarget);\n  };\n  const handleMenuClose = () => {\n    setAnchorEl(null);\n  };\n  const handleBackgroundSelect = () => {\n    setIsBackgroundDialogOpen(true);\n    handleMenuClose();\n  };\n  const handleBackgroundDialogClose = () => {\n    setIsBackgroundDialogOpen(false);\n  };\n  const handleVolumeChange = (event, newValue) => {\n    setBackgroundMusicVolume(newValue);\n  };\n  const handleNicknameEdit = () => {\n    setIsEditingNickname(true);\n    // 在下一个渲染周期后聚焦输入框\n    setTimeout(() => {\n      var _nicknameInputRef$cur;\n      (_nicknameInputRef$cur = nicknameInputRef.current) === null || _nicknameInputRef$cur === void 0 ? void 0 : _nicknameInputRef$cur.focus();\n    }, 0);\n  };\n  const handleNicknameSave = () => {\n    setIsEditingNickname(false);\n  };\n  const handleNicknameChange = event => {\n    setNickname(event.target.value.trim());\n  };\n  const handleNicknameKeyPress = event => {\n    if (event.key === 'Enter') {\n      handleNicknameSave();\n    }\n  };\n  return /*#__PURE__*/React.createElement(ThemeProvider, {\n    theme: darkTheme,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 464,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(Box, {\n    sx: {\n      height: '100vh',\n      width: '100%',\n      position: 'fixed',\n      top: 0,\n      left: 0,\n      display: 'flex',\n      flexDirection: 'column',\n      overflow: 'hidden',\n      paddingBottom: '56px' // 为底部导航栏预留空间\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 465,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(Box, {\n    sx: {\n      p: 2,\n      display: 'flex',\n      alignItems: 'center',\n      justifyContent: 'space-between',\n      backdropFilter: 'blur(10px)',\n      bgcolor: 'rgba(0, 0, 0, 0.3)'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 479,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Box, {\n    sx: {\n      display: 'flex',\n      alignItems: 'center',\n      gap: 2\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 489,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(Box, {\n    component: \"img\",\n    src: characterInfo.avatar,\n    sx: {\n      width: 40,\n      height: 40,\n      borderRadius: '50%'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 490,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(Box, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 499,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(Typography, {\n    variant: \"subtitle1\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 500,\n      columnNumber: 15\n    }\n  }, characterInfo.name), /*#__PURE__*/React.createElement(Typography, {\n    variant: \"caption\",\n    sx: {\n      color: 'text.secondary'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 501,\n      columnNumber: 15\n    }\n  }, (characterInfo.connections / 10000).toFixed(1), \"\\u4E07 \\u8FDE\\u63A5\\u8005\"))), /*#__PURE__*/React.createElement(Box, {\n    sx: {\n      display: 'flex',\n      gap: 1\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 506,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(IconButton, {\n    onClick: () => setShowMessages(!showMessages),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 507,\n      columnNumber: 13\n    }\n  }, showMessages ? /*#__PURE__*/React.createElement(ExpandLessIcon, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 508,\n      columnNumber: 31\n    }\n  }) : /*#__PURE__*/React.createElement(ExpandMoreIcon, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 508,\n      columnNumber: 52\n    }\n  })), /*#__PURE__*/React.createElement(IconButton, {\n    onClick: () => setIsMusicEnabled(!isMusicEnabled),\n    sx: {\n      color: isMusicEnabled ? 'primary.main' : 'text.secondary'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 510,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(MusicNoteIcon, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 516,\n      columnNumber: 15\n    }\n  })), /*#__PURE__*/React.createElement(IconButton, {\n    onClick: handleMenuClick,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 518,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(MenuIcon, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 519,\n      columnNumber: 15\n    }\n  })))), /*#__PURE__*/React.createElement(Menu, {\n    anchorEl: anchorEl,\n    open: Boolean(anchorEl),\n    onClose: handleMenuClose,\n    transformOrigin: {\n      horizontal: 'right',\n      vertical: 'top'\n    },\n    anchorOrigin: {\n      horizontal: 'right',\n      vertical: 'bottom'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 525,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(List, {\n    sx: {\n      width: '300px',\n      bgcolor: 'background.paper',\n      p: 0\n    },\n    subheader: /*#__PURE__*/React.createElement(ListSubheader, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 538,\n        columnNumber: 24\n      }\n    }, \"\\u8BBE\\u7F6E\"),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 532,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(ListItem, {\n    button: true,\n    onClick: handleNicknameEdit,\n    sx: {\n      '&:hover': {\n        bgcolor: 'rgba(255, 255, 255, 0.08)'\n      }\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 540,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(ListItemIcon, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 549,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(PersonIcon, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 550,\n      columnNumber: 17\n    }\n  })), isEditingNickname ? /*#__PURE__*/React.createElement(TextField, {\n    inputRef: nicknameInputRef,\n    value: nickname,\n    onChange: handleNicknameChange,\n    onBlur: handleNicknameSave,\n    onKeyPress: handleNicknameKeyPress,\n    placeholder: \"\\u8F93\\u5165\\u65B0\\u7684\\u79F0\\u547C\",\n    size: \"small\",\n    fullWidth: true,\n    autoFocus: true,\n    sx: {\n      '& .MuiInputBase-root': {\n        color: 'text.primary'\n      }\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 553,\n      columnNumber: 17\n    }\n  }) : /*#__PURE__*/React.createElement(ListItemText, {\n    primary: \"\\u4ED6\\u5BF9\\u6211\\u7684\\u79F0\\u547C\",\n    secondary: nickname || /*#__PURE__*/React.createElement(Typography, {\n      variant: \"body2\",\n      sx: {\n        color: 'text.disabled'\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 572,\n        columnNumber: 42\n      }\n    }, \"\\u9ED8\\u8BA4\"),\n    sx: {\n      pr: 2\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 570,\n      columnNumber: 17\n    }\n  })), /*#__PURE__*/React.createElement(Divider, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 578,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(ListSubheader, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 580,\n      columnNumber: 13\n    }\n  }, \"\\u5BF9\\u8BDD\\u8BBE\\u7F6E\"), /*#__PURE__*/React.createElement(ListItem, {\n    button: true,\n    onClick: handleBackgroundSelect,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 581,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(ListItemIcon, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 582,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(WallpaperIcon, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 583,\n      columnNumber: 17\n    }\n  })), /*#__PURE__*/React.createElement(ListItemText, {\n    primary: \"\\u66F4\\u6539\\u80CC\\u666F\\u56FE\\u7247\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 585,\n      columnNumber: 15\n    }\n  })), /*#__PURE__*/React.createElement(Divider, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 588,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(ListSubheader, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 590,\n      columnNumber: 13\n    }\n  }, \"\\u58F0\\u97F3\\u8BBE\\u7F6E\"), /*#__PURE__*/React.createElement(ListItem, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 591,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(ListItemIcon, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 592,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(PlayCircleIcon, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 593,\n      columnNumber: 17\n    }\n  })), /*#__PURE__*/React.createElement(ListItemText, {\n    primary: \"\\u81EA\\u52A8\\u64AD\\u653E\\u5BF9\\u8BDD\\u8BED\\u97F3\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 595,\n      columnNumber: 15\n    }\n  }), /*#__PURE__*/React.createElement(Switch, {\n    edge: \"end\",\n    checked: autoPlayVoice,\n    onChange: e => setAutoPlayVoice(e.target.checked),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 596,\n      columnNumber: 15\n    }\n  })), /*#__PURE__*/React.createElement(ListItem, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 602,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(ListItemIcon, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 603,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(VolumeUpIcon, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 604,\n      columnNumber: 17\n    }\n  })), /*#__PURE__*/React.createElement(ListItemText, {\n    primary: \"\\u5BF9\\u8BDD\\u8BED\\u97F3\\u5185\\u5BB9\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 606,\n      columnNumber: 15\n    }\n  })), /*#__PURE__*/React.createElement(ListItem, {\n    sx: {\n      pl: 4\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 608,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(ListItemText, {\n    primary: \"\\u4ED6\\u7684\\u8BF4\\u8BDD\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 609,\n      columnNumber: 15\n    }\n  }), /*#__PURE__*/React.createElement(Switch, {\n    edge: \"end\",\n    checked: voiceSettings.dialogue,\n    onChange: e => setVoiceSettings(prev => ({\n      ...prev,\n      dialogue: e.target.checked\n    })),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 610,\n      columnNumber: 15\n    }\n  })), /*#__PURE__*/React.createElement(ListItem, {\n    sx: {\n      pl: 4\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 616,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(ListItemText, {\n    primary: \"\\u4ED6\\u7684\\u5FC3\\u58F0\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 617,\n      columnNumber: 15\n    }\n  }), /*#__PURE__*/React.createElement(Switch, {\n    edge: \"end\",\n    checked: voiceSettings.thoughts,\n    onChange: e => setVoiceSettings(prev => ({\n      ...prev,\n      thoughts: e.target.checked\n    })),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 618,\n      columnNumber: 15\n    }\n  })), /*#__PURE__*/React.createElement(ListItem, {\n    sx: {\n      pl: 4\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 624,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(ListItemText, {\n    primary: \"\\u65C1\\u767D\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 625,\n      columnNumber: 15\n    }\n  }), /*#__PURE__*/React.createElement(Switch, {\n    edge: \"end\",\n    checked: voiceSettings.narration,\n    onChange: e => setVoiceSettings(prev => ({\n      ...prev,\n      narration: e.target.checked\n    })),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 626,\n      columnNumber: 15\n    }\n  })), /*#__PURE__*/React.createElement(ListItem, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 632,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(ListItemIcon, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 633,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(MusicNoteIcon, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 634,\n      columnNumber: 17\n    }\n  })), /*#__PURE__*/React.createElement(ListItemText, {\n    primary: \"\\u80CC\\u666F\\u97F3\\u4E50\\u97F3\\u91CF\",\n    secondary: /*#__PURE__*/React.createElement(Slider, {\n      value: backgroundMusicVolume,\n      onChange: handleVolumeChange,\n      \"aria-labelledby\": \"background-music-volume-slider\",\n      sx: {\n        mt: 2\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 639,\n        columnNumber: 19\n      }\n    }),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 636,\n      columnNumber: 15\n    }\n  })))), /*#__PURE__*/React.createElement(Dialog, {\n    open: isBackgroundDialogOpen,\n    onClose: handleBackgroundDialogClose,\n    maxWidth: \"md\",\n    fullWidth: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 652,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(DialogTitle, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 658,\n      columnNumber: 11\n    }\n  }, \"\\u9009\\u62E9\\u80CC\\u666F\\u56FE\\u7247\"), /*#__PURE__*/React.createElement(DialogContent, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 659,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(Grid, {\n    container: true,\n    spacing: 2,\n    sx: {\n      mt: 1\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 660,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(Grid, {\n    item: true,\n    xs: 4,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 662,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(Paper, {\n    sx: {\n      height: 120,\n      backgroundImage: 'url(/images/backgrounds/bg1.jpg)',\n      backgroundSize: 'cover',\n      cursor: 'pointer',\n      '&:hover': {\n        opacity: 0.8\n      }\n    },\n    onClick: () => {\n      // 处理背景图片选择\n      handleBackgroundDialogClose();\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 663,\n      columnNumber: 17\n    }\n  }))))), /*#__PURE__*/React.createElement(Box, {\n    sx: {\n      flex: 1\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 685,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(Box, {\n    ref: messagesContainerRef,\n    sx: {\n      height: '50vh',\n      overflowY: 'auto',\n      overflowX: 'hidden',\n      '&::-webkit-scrollbar': {\n        display: 'none'\n      },\n      scrollbarWidth: 'none',\n      msOverflowStyle: 'none',\n      px: 2,\n      py: 1\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 688,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Collapse, {\n    in: showMessages,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 704,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(Box, {\n    sx: {\n      height: '100%',\n      overflow: 'auto',\n      display: 'flex',\n      flexDirection: 'column',\n      alignItems: 'flex-start',\n      px: 2,\n      py: 3,\n      gap: 3\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 705,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(Paper, {\n    sx: {\n      p: 2,\n      bgcolor: 'rgba(32, 32, 32, 0.75)',\n      borderRadius: 2,\n      backdropFilter: 'blur(10px)',\n      width: '80%',\n      maxWidth: '600px',\n      position: 'relative'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 718,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(Box, {\n    sx: {\n      width: '95%',\n      height: isIntroExpanded ? 'auto' : '4.8em',\n      overflow: 'hidden',\n      transition: 'height 0.3s ease'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 729,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(Typography, {\n    variant: \"body1\",\n    sx: {\n      mb: 1,\n      fontWeight: 'bold',\n      color: 'text.primary'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 737,\n      columnNumber: 19\n    }\n  }, \"\\u7B80\\u4ECB\"), /*#__PURE__*/React.createElement(Typography, {\n    variant: \"body1\",\n    sx: {\n      mb: 1\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 747,\n      columnNumber: 19\n    }\n  }, characterInfo.introduction), /*#__PURE__*/React.createElement(Box, {\n    sx: {\n      display: 'flex',\n      alignItems: 'center',\n      gap: 1,\n      color: 'text.secondary'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 750,\n      columnNumber: 19\n    }\n  }, /*#__PURE__*/React.createElement(MusicNoteIcon, {\n    fontSize: \"small\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 751,\n      columnNumber: 21\n    }\n  }), /*#__PURE__*/React.createElement(Typography, {\n    variant: \"body2\",\n    sx: {\n      fontStyle: 'italic'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 752,\n      columnNumber: 21\n    }\n  }, characterInfo.backgroundStory))), /*#__PURE__*/React.createElement(IconButton, {\n    size: \"small\",\n    onClick: () => setIsIntroExpanded(!isIntroExpanded),\n    sx: {\n      position: 'absolute',\n      right: 8,\n      bottom: 8,\n      bgcolor: 'rgba(0, 0, 0, 0.2)',\n      '&:hover': {\n        bgcolor: 'rgba(0, 0, 0, 0.4)'\n      }\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 757,\n      columnNumber: 17\n    }\n  }, isIntroExpanded ? /*#__PURE__*/React.createElement(ExpandLessIcon, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 770,\n      columnNumber: 38\n    }\n  }) : /*#__PURE__*/React.createElement(ExpandMoreIcon, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 770,\n      columnNumber: 59\n    }\n  }))), messages.map(message => {\n    var _message$narration;\n    return /*#__PURE__*/React.createElement(Box, {\n      key: message.id,\n      sx: {\n        display: 'flex',\n        flexDirection: 'column',\n        alignItems: message.sender === 'user' ? 'flex-end' : 'flex-start',\n        width: '100%'\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 775,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(Box, {\n      sx: {\n        display: 'flex',\n        alignItems: 'flex-end',\n        gap: 1,\n        ...(message.sender === 'user' ? {\n          width: 'fit-content',\n          maxWidth: {\n            xs: '70%',\n            sm: '65%'\n          }\n        } : {\n          width: '80%',\n          maxWidth: '600px'\n        }),\n        ml: message.sender === 'user' ? 'auto' : 0,\n        mr: message.sender === 'user' ? 0 : 'auto'\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 784,\n        columnNumber: 19\n      }\n    }, message.sender === 'character' && /*#__PURE__*/React.createElement(Box, {\n      sx: {\n        position: 'relative'\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 807,\n        columnNumber: 23\n      }\n    }, /*#__PURE__*/React.createElement(IconButton, {\n      size: \"small\",\n      onClick: () => handlePlayVoice(message.id),\n      sx: {\n        position: 'absolute',\n        left: -40,\n        bottom: 0,\n        bgcolor: 'rgba(0, 0, 0, 0.2)',\n        '&:hover': {\n          bgcolor: 'rgba(0, 0, 0, 0.4)'\n        }\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 808,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(PlayArrowIcon, {\n      fontSize: \"small\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 821,\n        columnNumber: 27\n      }\n    }), isPlaying === message.id && /*#__PURE__*/React.createElement(Typography, {\n      variant: \"caption\",\n      sx: {\n        position: 'absolute',\n        left: -20,\n        color: 'text.secondary'\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 823,\n        columnNumber: 29\n      }\n    }, \"3\\\"\"))), /*#__PURE__*/React.createElement(Paper, {\n      sx: {\n        p: 2,\n        bgcolor: message.sender === 'user' ? 'rgba(245, 235, 224, 0.75)' : 'rgba(32, 32, 32, 0.75)',\n        borderRadius: 2,\n        backdropFilter: 'blur(10px)',\n        boxShadow: '0 2px 12px rgba(0,0,0,0.1)',\n        width: '100%',\n        position: 'relative'\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 837,\n        columnNumber: 21\n      }\n    }, message.sender === 'character' ? /*#__PURE__*/React.createElement(Box, {\n      sx: {\n        position: 'relative'\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 849,\n        columnNumber: 25\n      }\n    }, (_message$narration = message.narration) === null || _message$narration === void 0 ? void 0 : _message$narration.map((text, index) => /*#__PURE__*/React.createElement(Typography, {\n      key: index,\n      variant: \"body2\",\n      sx: {\n        color: 'text.secondary',\n        fontSize: '0.85rem',\n        mb: 1,\n        width: '95%',\n        textAlign: 'left'\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 851,\n        columnNumber: 29\n      }\n    }, text)), message.dialogue && /*#__PURE__*/React.createElement(Typography, {\n      variant: \"body1\",\n      sx: {\n        color: '#FFA500',\n        mb: 1,\n        width: '95%',\n        textAlign: 'left'\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 866,\n        columnNumber: 29\n      }\n    }, \"\\\"\", message.dialogue, \"\\\"\"), message.thoughts && /*#__PURE__*/React.createElement(Typography, {\n      variant: \"body1\",\n      sx: {\n        color: 'rgba(255, 255, 255, 0.6)',\n        fontStyle: 'italic',\n        mb: 1,\n        width: '95%',\n        textAlign: 'left'\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 879,\n        columnNumber: 29\n      }\n    }, \"(\", message.thoughts, \")\"), /*#__PURE__*/React.createElement(Box, {\n      sx: {\n        position: 'absolute',\n        right: -48,\n        top: '50%',\n        transform: 'translateY(-50%)'\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 892,\n        columnNumber: 27\n      }\n    }, /*#__PURE__*/React.createElement(IconButton, {\n      size: \"small\",\n      onClick: () => handlePlayVoice(message.id),\n      disabled: message.isVoiceLoading,\n      sx: {\n        bgcolor: 'rgba(32, 32, 32, 0.75)',\n        backdropFilter: 'blur(10px)',\n        '&:hover': {\n          bgcolor: 'rgba(32, 32, 32, 0.9)'\n        }\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 900,\n        columnNumber: 29\n      }\n    }, message.isVoiceLoading ? /*#__PURE__*/React.createElement(CircularProgress, {\n      size: 20,\n      thickness: 4,\n      sx: {\n        color: 'rgba(255, 255, 255, 0.7)'\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 913,\n        columnNumber: 33\n      }\n    }) : /*#__PURE__*/React.createElement(VolumeUpIcon, {\n      fontSize: \"small\",\n      sx: {\n        color: playingMessageId === message.id ? 'primary.main' : 'rgba(255, 255, 255, 0.7)'\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 915,\n        columnNumber: 33\n      }\n    })))) : /*#__PURE__*/React.createElement(Typography, {\n      variant: \"body1\",\n      sx: {\n        color: '#333333',\n        textAlign: 'left',\n        width: '100%',\n        minWidth: '4em'\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 926,\n        columnNumber: 25\n      }\n    }, message.content))));\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    ref: messagesEndRef,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 942,\n      columnNumber: 15\n    }\n  })))), /*#__PURE__*/React.createElement(Box, {\n    sx: {\n      p: 2,\n      width: '100%',\n      backdropFilter: 'blur(10px)',\n      bgcolor: 'rgba(0, 0, 0, 0.3)',\n      borderTop: '1px solid rgba(255, 255, 255, 0.1)',\n      position: 'relative',\n      zIndex: 1200\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 948,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Box, {\n    component: \"form\",\n    onSubmit: e => {\n      e.preventDefault();\n      handleSendMessage();\n    },\n    sx: {\n      display: 'flex',\n      alignItems: 'center',\n      gap: 1,\n      bgcolor: 'rgba(32, 32, 32, 0.5)',\n      borderRadius: 2,\n      p: 1\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 959,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(IconButton, {\n    sx: {\n      color: 'text.secondary'\n    },\n    onClick: () => {/* TODO: 实现语音通话功能 */},\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 974,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(CallIcon, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 978,\n      columnNumber: 15\n    }\n  })), /*#__PURE__*/React.createElement(TextField, {\n    fullWidth: true,\n    multiline: true,\n    maxRows: 4,\n    value: inputMessage,\n    onChange: e => setInputMessage(e.target.value),\n    onKeyPress: handleKeyPress,\n    placeholder: \"\\u53D1\\u9001\\u6D88\\u606F\\u7ED9\\u6E29\\u67D4\\u603B\\u88C1\",\n    variant: \"standard\",\n    sx: {\n      '& .MuiInputBase-root': {\n        color: 'text.primary',\n        '&::before, &::after': {\n          display: 'none'\n        }\n      },\n      '& .MuiInputBase-input': {\n        p: 1\n      }\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 980,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(IconButton, {\n    sx: {\n      color: 'text.secondary'\n    },\n    onClick: () => {/* TODO: 实现语音输入功能 */},\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1001,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(MicIcon, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1005,\n      columnNumber: 15\n    }\n  })), /*#__PURE__*/React.createElement(IconButton, {\n    sx: {\n      color: 'text.secondary'\n    },\n    onClick: handleSendMessage,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1007,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(SendIcon, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1011,\n      columnNumber: 15\n    }\n  }))))));\n};\nexport default Chat;","map":{"version":3,"names":["React","useState","useRef","useEffect","useParams","Box","Paper","TextField","IconButton","Typography","keyframes","createTheme","ThemeProvider","Collapse","CircularProgress","Menu","ListItemIcon","ListItemText","Dialog","DialogTitle","DialogContent","Grid","Switch","Slider","Divider","List","ListItem","ListSubheader","Send","SendIcon","Mic","MicIcon","MenuIcon","VolumeUp","VolumeUpIcon","ExpandMore","ExpandMoreIcon","ExpandLess","ExpandLessIcon","MusicNote","MusicNoteIcon","PlayArrow","PlayArrowIcon","Call","CallIcon","Person","PersonIcon","Wallpaper","WallpaperIcon","PlayCircle","PlayCircleIcon","darkTheme","palette","mode","background","default","paper","text","primary","secondary","bubbleAppear","Chat","characterId","showMessages","setShowMessages","isIntroExpanded","setIsIntroExpanded","isPlaying","setIsPlaying","isMusicEnabled","setIsMusicEnabled","characterInfo","id","name","avatar","introduction","backgroundStory","height","age","connections","openingMessage","content","sceneDescription","actionDescription","messages","setMessages","inputMessage","setInputMessage","isVoiceEnabled","setIsVoiceEnabled","messagesEndRef","characterImageRef","playingMessageId","setPlayingMessageId","messagesContainerRef","isNearBottom","setIsNearBottom","isUserScrolling","setIsUserScrolling","userScrollTimeoutRef","isVoicePlaying","setIsVoicePlaying","anchorEl","setAnchorEl","isBackgroundDialogOpen","setIsBackgroundDialogOpen","autoPlayVoice","setAutoPlayVoice","backgroundMusicVolume","setBackgroundMusicVolume","voiceSettings","setVoiceSettings","dialogue","thoughts","narration","nickname","setNickname","isEditingNickname","setIsEditingNickname","nicknameInputRef","voiceConfig","dialogueVoice","narrationVoice","thoughtsVolumeReduction","checkIfNearBottom","container","current","scrollHeight","scrollTop","clientHeight","distanceFromBottom","handleUserScroll","clearTimeout","setTimeout","scrollToBottom","_messagesEndRef$curre","scrollIntoView","behavior","addEventListener","removeEventListener","length","lastMessage","isVoiceLoading","sender","timestamp","Date","handleKeyPress","event","key","shiftKey","preventDefault","handleSendMessage","messageContent","trim","newMessage","now","prev","aiResponse","getVoiceContent","message","push","voiceType","forEach","playVoiceContent","item","console","log","voice","volume","Promise","resolve","error","handlePlayVoice","messageId","currentMessage","find","msg","prevMessages","map","voiceContent","truncateText","maxLength","slice","handleMenuClick","currentTarget","handleMenuClose","handleBackgroundSelect","handleBackgroundDialogClose","handleVolumeChange","newValue","handleNicknameEdit","_nicknameInputRef$cur","focus","handleNicknameSave","handleNicknameChange","target","value","handleNicknameKeyPress","createElement","theme","__self","__source","fileName","_jsxFileName","lineNumber","columnNumber","sx","width","position","top","left","display","flexDirection","overflow","paddingBottom","p","alignItems","justifyContent","backdropFilter","bgcolor","gap","component","src","borderRadius","variant","color","toFixed","onClick","open","Boolean","onClose","transformOrigin","horizontal","vertical","anchorOrigin","subheader","button","inputRef","onChange","onBlur","onKeyPress","placeholder","size","fullWidth","autoFocus","pr","edge","checked","e","pl","mt","maxWidth","spacing","xs","backgroundImage","backgroundSize","cursor","opacity","flex","ref","overflowY","overflowX","scrollbarWidth","msOverflowStyle","px","py","in","transition","mb","fontWeight","fontSize","fontStyle","right","bottom","_message$narration","sm","ml","mr","boxShadow","index","textAlign","transform","disabled","thickness","minWidth","borderTop","zIndex","onSubmit","multiline","maxRows"],"sources":["C:/D/AI_role/Accompany_women/frontend/src/pages/Chat.tsx"],"sourcesContent":["import React, { useState, useRef, useEffect } from 'react';\nimport { useParams } from 'react-router-dom';\nimport {\n  Box,\n  Paper,\n  TextField,\n  IconButton,\n  Typography,\n  Tooltip,\n  keyframes,\n  createTheme,\n  ThemeProvider,\n  Collapse,\n  Zoom,\n  CircularProgress,\n  Menu,\n  MenuItem,\n  ListItemIcon,\n  ListItemText,\n  Dialog,\n  DialogTitle,\n  DialogContent,\n  Grid,\n  Switch,\n  Slider,\n  Divider,\n  List,\n  ListItem,\n  ListSubheader,\n} from '@mui/material';\nimport {\n  Send as SendIcon,\n  Mic as MicIcon,\n  Search as SearchIcon,\n  Menu as MenuIcon,\n  Add as AddIcon,\n  VolumeUp as VolumeUpIcon,\n  VolumeOff as VolumeOffIcon,\n  ExpandMore as ExpandMoreIcon,\n  ExpandLess as ExpandLessIcon,\n  MusicNote as MusicNoteIcon,\n  ZoomIn as ZoomInIcon,\n  ZoomOut as ZoomOutIcon,\n  PlayArrow as PlayArrowIcon,\n  Call as CallIcon,\n  Person as PersonIcon,\n  Settings as SettingsIcon,\n  Wallpaper as WallpaperIcon,\n  VolumeUp as SoundIcon,\n  PlayCircle as PlayCircleIcon,\n} from '@mui/icons-material';\n\n// 定义深色主题\nconst darkTheme = createTheme({\n  palette: {\n    mode: 'dark',\n    background: {\n      default: '#000000',\n      paper: 'rgba(32, 32, 32, 0.8)',\n    },\n    text: {\n      primary: '#ffffff',\n      secondary: 'rgba(255, 255, 255, 0.7)',\n    },\n  },\n});\n\n// 定义气泡动画\nconst bubbleAppear = keyframes`\n  0% {\n    opacity: 0;\n    transform: translateY(10px);\n  }\n  100% {\n    opacity: 1;\n    transform: translateY(0);\n  }\n`;\n\ninterface Message {\n  id: number;\n  content?: string;  // 可选，用于用户消息\n  narration?: string[];  // 旁白\n  dialogue?: string;     // 角色说话\n  thoughts?: string;     // 角色心声\n  sender: 'user' | 'character';\n  timestamp: Date;\n  isVoiceLoading?: boolean;\n}\n\ninterface CharacterInfo {\n  id: string;\n  name: string;\n  avatar: string;\n  introduction: string;\n  backgroundStory: string;\n  height: string;\n  age: number;\n  connections: number;\n  openingMessage: {\n    content: string;\n    sceneDescription?: string;\n    actionDescription?: string;\n  };\n}\n\ninterface VoiceConfig {\n  dialogueVoice: string;  // 说话声音配置\n  narrationVoice: string; // 旁白声音配置\n  thoughtsVolumeReduction: number; // 心声音量降低的分贝数\n}\n\nconst Chat: React.FC = () => {\n  const { characterId } = useParams<{ characterId: string }>();\n  const [showMessages, setShowMessages] = useState(true);\n  const [isIntroExpanded, setIsIntroExpanded] = useState(false);\n  const [isPlaying, setIsPlaying] = useState<number | null>(null);\n  const [isMusicEnabled, setIsMusicEnabled] = useState(true);\n  const [characterInfo] = useState<CharacterInfo>({\n    id: '1',\n    name: '罗峻雪',\n    avatar: '/images/characters/ceo.jpg',\n    introduction: '极为顽劣的财阀小少爷,少年细腰,雪发花眸,有一半的日耳曼血统,小名schlanke Schöne.(细腰美人)',\n    backgroundStory: '一度想把自己的名字改为罗素腰,但是被母亲强烈反对...',\n    height: '188cm',\n    age: 27,\n    connections: 794000,\n    openingMessage: {\n      content: '你这个可爱的小野猫',\n      sceneDescription: '（纸醉金迷,素手执杯,纸牌骰子,冰冷的珠宝映着富贵浮华的颜色,水蛇般的身躯慵懒倚靠）',\n      actionDescription: '（少年半靠在沙发里，身边簇拥着一群男生，有人喝酒有人递烟，他低着头把玩着长链手机，睫毛颤颤的，樱花色的薄唇被酒液浸润，透着一股无辜的艳色）',\n    }\n  });\n  \n  const [messages, setMessages] = useState<Message[]>([]);\n  const [inputMessage, setInputMessage] = useState('');\n  const [isVoiceEnabled, setIsVoiceEnabled] = useState(true);\n  const messagesEndRef = useRef<HTMLDivElement>(null);\n  const characterImageRef = useRef<HTMLImageElement>(null);\n  const [playingMessageId, setPlayingMessageId] = useState<number | null>(null);\n  const messagesContainerRef = useRef<HTMLDivElement>(null);\n  const [isNearBottom, setIsNearBottom] = useState(true);\n  const [isUserScrolling, setIsUserScrolling] = useState(false);\n  const userScrollTimeoutRef = useRef<NodeJS.Timeout>();\n  const [isVoicePlaying, setIsVoicePlaying] = useState(false);\n  const [anchorEl, setAnchorEl] = useState<null | HTMLElement>(null);\n  const [isBackgroundDialogOpen, setIsBackgroundDialogOpen] = useState(false);\n  const [autoPlayVoice, setAutoPlayVoice] = useState(false);\n  const [backgroundMusicVolume, setBackgroundMusicVolume] = useState(50);\n  const [voiceSettings, setVoiceSettings] = useState({\n    dialogue: true,\n    thoughts: false,\n    narration: false,\n  });\n  const [nickname, setNickname] = useState<string>('');\n  const [isEditingNickname, setIsEditingNickname] = useState(false);\n  const nicknameInputRef = useRef<HTMLInputElement>(null);\n  const [voiceConfig] = useState<VoiceConfig>({\n    dialogueVoice: 'voice1',  // 示例声音配置\n    narrationVoice: 'voice2',\n    thoughtsVolumeReduction: 3, // 降低3分贝\n  });\n\n  const checkIfNearBottom = () => {\n    const container = messagesContainerRef.current;\n    if (container) {\n      const { scrollHeight, scrollTop, clientHeight } = container;\n      const distanceFromBottom = scrollHeight - scrollTop - clientHeight;\n      setIsNearBottom(distanceFromBottom < 500);\n    }\n  };\n\n  const handleUserScroll = () => {\n    setIsUserScrolling(true);\n    \n    // Clear any existing timeout\n    if (userScrollTimeoutRef.current) {\n      clearTimeout(userScrollTimeoutRef.current);\n    }\n    \n    // Reset the user scrolling state after 150ms of no scroll events\n    userScrollTimeoutRef.current = setTimeout(() => {\n      setIsUserScrolling(false);\n    }, 150);\n    \n    checkIfNearBottom();\n  };\n\n  const scrollToBottom = () => {\n    // 只有在不是播放语音的情况下，且在底部500px范围内时才自动滚动\n    if (isNearBottom && !isVoicePlaying) {\n      messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });\n    }\n  };\n\n  // 监听消息区域的滚动事件\n  useEffect(() => {\n    const container = messagesContainerRef.current;\n    if (container) {\n      container.addEventListener('scroll', handleUserScroll);\n      return () => {\n        container.removeEventListener('scroll', handleUserScroll);\n        if (userScrollTimeoutRef.current) {\n          clearTimeout(userScrollTimeoutRef.current);\n        }\n      };\n    }\n  }, []);\n\n  // 监听消息变化\n  useEffect(() => {\n    if (messages.length > 0) {\n      const lastMessage = messages[messages.length - 1];\n      // 只在新消息（非语音状态更新）时检查是否需要滚动\n      if (!lastMessage.isVoiceLoading) {\n        scrollToBottom();\n      }\n    }\n  }, [messages, isNearBottom]);\n\n  useEffect(() => {\n    // Add opening message and example responses when component mounts\n    setMessages([\n      {\n        id: 1,\n        narration: [\n          \"纸醉金迷，素手执杯，纸牌骰子，冰冷的珠宝映着富贵浮华的颜色，水蛇般的身躯慵懒倚靠\",\n          \"少年半靠在沙发里，身边簇拥着一群男生，有人喝酒有人递烟，他低着头把玩着长链手机，睫毛颤颤的，樱花色的薄唇被酒液浸润，透着一股无辜的艳色\"\n        ],\n        dialogue: \"你这个可爱的小野猫\",\n        sender: 'character',\n        timestamp: new Date(),\n      },\n      {\n        id: 2,\n        content: \"你好呀~\",\n        sender: 'user',\n        timestamp: new Date(),\n      },\n      {\n        id: 3,\n        narration: [\"抬起头来，露出一个慵懒而迷人的微笑，手指轻轻敲击着高脚杯\", \n                   \"将手机放在一旁，示意身边的人群稍稍退开，为你留出一个位置\"],\n        dialogue: \"哦？这不是我们可爱的小客人吗\",\n        sender: 'character',\n        timestamp: new Date(),\n      },\n      {\n        id: 4,\n        content: \"我可以坐在这里吗？\",\n        sender: 'user',\n        timestamp: new Date(),\n      },\n      {\n        id: 5,\n        narration: [\n          \"水晶吊灯的光芒在他银色的发丝间流转，映照出一片梦幻般的光晕\",\n          \"优雅地挪了挪位置，修长的手指轻拍身边的沙发座位，嘴角勾起一抹意味深长的笑\"\n        ],\n        dialogue: \"当然可以，我可爱的小猫咪。这个位置，我可是特意为你留的呢\",\n        thoughts: \"真是个有趣的小家伙\",\n        sender: 'character',\n        timestamp: new Date(),\n      }\n    ]);\n  }, [characterInfo]);\n\n  const handleKeyPress = (event: React.KeyboardEvent) => {\n    if (event.key === 'Enter' && !event.shiftKey) {\n      event.preventDefault();\n      handleSendMessage();\n    }\n  };\n\n  const handleSendMessage = () => {\n    const messageContent = inputMessage.trim() || \"继续\";\n    const newMessage = {\n      id: Date.now(),\n      content: messageContent,\n      sender: 'user' as const,\n      timestamp: new Date(),\n    };\n\n    setIsVoicePlaying(false);\n    setMessages(prev => [...prev, newMessage]);\n    setInputMessage('');\n\n    // 模拟AI回复\n    setTimeout(() => {\n      const aiResponse = {\n        id: Date.now(),\n        narration: [\"轻轻地笑了笑\", \"优雅地端起酒杯，轻轻摇晃\"],\n        dialogue: \"这是AI的回复消息\",\n        thoughts: \"希望能和你聊得开心\",\n        sender: 'character' as const,\n        timestamp: new Date(),\n      };\n      setMessages(prev => [...prev, aiResponse]);\n    }, 1000);\n  };\n\n  // 获取要播放的文本内容\n  const getVoiceContent = (message: Message): { text: string, voiceType: 'dialogue' | 'narration' | 'thoughts' }[] => {\n    const content: { text: string, voiceType: 'dialogue' | 'narration' | 'thoughts' }[] = [];\n\n    if (voiceSettings.dialogue && message.dialogue) {\n      content.push({ text: message.dialogue, voiceType: 'dialogue' });\n    }\n\n    if (voiceSettings.thoughts && message.thoughts) {\n      content.push({ text: message.thoughts, voiceType: 'thoughts' });\n    }\n\n    if (voiceSettings.narration && message.narration) {\n      message.narration.forEach(text => {\n        content.push({ text, voiceType: 'narration' });\n      });\n    }\n\n    return content;\n  };\n\n  // 播放语音的函数\n  const playVoiceContent = async (content: { text: string, voiceType: 'dialogue' | 'narration' | 'thoughts' }[]) => {\n    for (const item of content) {\n      try {\n        // 这里是语音合成的模拟，实际实现时需要替换为真实的语音合成API调用\n        console.log(`Playing ${item.voiceType}:`, item.text);\n        console.log('Voice settings:', {\n          voice: item.voiceType === 'dialogue' ? voiceConfig.dialogueVoice :\n                item.voiceType === 'narration' ? voiceConfig.narrationVoice :\n                voiceConfig.dialogueVoice, // 心声使用对话声音\n          volume: item.voiceType === 'thoughts' ? \n                 `Reduced by ${voiceConfig.thoughtsVolumeReduction}db` : \n                 'Normal volume'\n        });\n        await new Promise(resolve => setTimeout(resolve, 2000)); // 模拟语音播放时间\n      } catch (error) {\n        console.error('语音合成失败:', error);\n      }\n    }\n  };\n\n  const handlePlayVoice = async (messageId: number) => {\n    setIsVoicePlaying(true);\n\n    if (playingMessageId === messageId) {\n      setPlayingMessageId(null);\n      setIsVoicePlaying(false);\n      // TODO: 停止语音播放的逻辑\n      return;\n    }\n\n    const currentMessage = messages.find(msg => msg.id === messageId);\n    if (!currentMessage || currentMessage?.isVoiceLoading) {\n      return;\n    }\n\n    setMessages(prevMessages => \n      prevMessages.map(msg => \n        msg.id === messageId \n          ? { ...msg, isVoiceLoading: true }\n          : msg\n      )\n    );\n\n    try {\n      const voiceContent = getVoiceContent(currentMessage);\n      if (voiceContent.length === 0) {\n        console.log('没有需要播放的语音内容');\n        return;\n      }\n\n      await playVoiceContent(voiceContent);\n      \n      setMessages(prevMessages => \n        prevMessages.map(msg => \n          msg.id === messageId \n            ? { ...msg, isVoiceLoading: false }\n            : msg\n        )\n      );\n      setPlayingMessageId(messageId);\n\n      // 播放完成后重置状态\n      setTimeout(() => {\n        setPlayingMessageId(null);\n        setIsVoicePlaying(false);\n      }, 1000);\n    } catch (error) {\n      console.error('语音播放失败:', error);\n      setMessages(prevMessages => \n        prevMessages.map(msg => \n          msg.id === messageId \n            ? { ...msg, isVoiceLoading: false }\n            : msg\n        )\n      );\n      setPlayingMessageId(null);\n      setIsVoicePlaying(false);\n    }\n  };\n\n  // 自动播放新消息的语音\n  useEffect(() => {\n    if (autoPlayVoice && messages.length > 0) {\n      const lastMessage = messages[messages.length - 1];\n      if (lastMessage.sender === 'character' && !lastMessage.isVoiceLoading) {\n        handlePlayVoice(lastMessage.id);\n      }\n    }\n  }, [messages, autoPlayVoice]);\n\n  // 截断文本的函数\n  const truncateText = (text: string, maxLength: number) => {\n    if (text.length <= maxLength) return text;\n    return text.slice(0, maxLength) + '...';\n  };\n\n  const handleMenuClick = (event: React.MouseEvent<HTMLElement>) => {\n    setAnchorEl(event.currentTarget);\n  };\n\n  const handleMenuClose = () => {\n    setAnchorEl(null);\n  };\n\n  const handleBackgroundSelect = () => {\n    setIsBackgroundDialogOpen(true);\n    handleMenuClose();\n  };\n\n  const handleBackgroundDialogClose = () => {\n    setIsBackgroundDialogOpen(false);\n  };\n\n  const handleVolumeChange = (event: Event, newValue: number | number[]) => {\n    setBackgroundMusicVolume(newValue as number);\n  };\n\n  const handleNicknameEdit = () => {\n    setIsEditingNickname(true);\n    // 在下一个渲染周期后聚焦输入框\n    setTimeout(() => {\n      nicknameInputRef.current?.focus();\n    }, 0);\n  };\n\n  const handleNicknameSave = () => {\n    setIsEditingNickname(false);\n  };\n\n  const handleNicknameChange = (event: React.ChangeEvent<HTMLInputElement>) => {\n    setNickname(event.target.value.trim());\n  };\n\n  const handleNicknameKeyPress = (event: React.KeyboardEvent) => {\n    if (event.key === 'Enter') {\n      handleNicknameSave();\n    }\n  };\n\n  return (\n    <ThemeProvider theme={darkTheme}>\n      <Box\n        sx={{\n          height: '100vh',\n          width: '100%',\n          position: 'fixed',\n          top: 0,\n          left: 0,\n          display: 'flex',\n          flexDirection: 'column',\n          overflow: 'hidden',\n          paddingBottom: '56px', // 为底部导航栏预留空间\n        }}\n      >\n        {/* 顶部信息栏 */}\n        <Box\n          sx={{\n            p: 2,\n            display: 'flex',\n            alignItems: 'center',\n            justifyContent: 'space-between',\n            backdropFilter: 'blur(10px)',\n            bgcolor: 'rgba(0, 0, 0, 0.3)',\n          }}\n        >\n          <Box sx={{ display: 'flex', alignItems: 'center', gap: 2 }}>\n            <Box\n              component=\"img\"\n              src={characterInfo.avatar}\n              sx={{\n                width: 40,\n                height: 40,\n                borderRadius: '50%',\n              }}\n            />\n            <Box>\n              <Typography variant=\"subtitle1\">{characterInfo.name}</Typography>\n              <Typography variant=\"caption\" sx={{ color: 'text.secondary' }}>\n                {(characterInfo.connections / 10000).toFixed(1)}万 连接者\n              </Typography>\n            </Box>\n          </Box>\n          <Box sx={{ display: 'flex', gap: 1 }}>\n            <IconButton onClick={() => setShowMessages(!showMessages)}>\n              {showMessages ? <ExpandLessIcon /> : <ExpandMoreIcon />}\n            </IconButton>\n            <IconButton \n              onClick={() => setIsMusicEnabled(!isMusicEnabled)}\n              sx={{\n                color: isMusicEnabled ? 'primary.main' : 'text.secondary',\n              }}\n            >\n              <MusicNoteIcon />\n            </IconButton>\n            <IconButton onClick={handleMenuClick}>\n              <MenuIcon />\n            </IconButton>\n          </Box>\n        </Box>\n\n        {/* 设置菜单 */}\n        <Menu\n          anchorEl={anchorEl}\n          open={Boolean(anchorEl)}\n          onClose={handleMenuClose}\n          transformOrigin={{ horizontal: 'right', vertical: 'top' }}\n          anchorOrigin={{ horizontal: 'right', vertical: 'bottom' }}\n        >\n          <List\n            sx={{\n              width: '300px',\n              bgcolor: 'background.paper',\n              p: 0,\n            }}\n            subheader={<ListSubheader>设置</ListSubheader>}\n          >\n            <ListItem\n              button\n              onClick={handleNicknameEdit}\n              sx={{\n                '&:hover': {\n                  bgcolor: 'rgba(255, 255, 255, 0.08)',\n                },\n              }}\n            >\n              <ListItemIcon>\n                <PersonIcon />\n              </ListItemIcon>\n              {isEditingNickname ? (\n                <TextField\n                  inputRef={nicknameInputRef}\n                  value={nickname}\n                  onChange={handleNicknameChange}\n                  onBlur={handleNicknameSave}\n                  onKeyPress={handleNicknameKeyPress}\n                  placeholder=\"输入新的称呼\"\n                  size=\"small\"\n                  fullWidth\n                  autoFocus\n                  sx={{\n                    '& .MuiInputBase-root': {\n                      color: 'text.primary',\n                    },\n                  }}\n                />\n              ) : (\n                <ListItemText \n                  primary=\"他对我的称呼\" \n                  secondary={nickname || <Typography variant=\"body2\" sx={{ color: 'text.disabled' }}>默认</Typography>}\n                  sx={{ pr: 2 }}\n                />\n              )}\n            </ListItem>\n            \n            <Divider />\n            \n            <ListSubheader>对话设置</ListSubheader>\n            <ListItem button onClick={handleBackgroundSelect}>\n              <ListItemIcon>\n                <WallpaperIcon />\n              </ListItemIcon>\n              <ListItemText primary=\"更改背景图片\" />\n            </ListItem>\n            \n            <Divider />\n            \n            <ListSubheader>声音设置</ListSubheader>\n            <ListItem>\n              <ListItemIcon>\n                <PlayCircleIcon />\n              </ListItemIcon>\n              <ListItemText primary=\"自动播放对话语音\" />\n              <Switch\n                edge=\"end\"\n                checked={autoPlayVoice}\n                onChange={(e) => setAutoPlayVoice(e.target.checked)}\n              />\n            </ListItem>\n            <ListItem>\n              <ListItemIcon>\n                <VolumeUpIcon />\n              </ListItemIcon>\n              <ListItemText primary=\"对话语音内容\" />\n            </ListItem>\n            <ListItem sx={{ pl: 4 }}>\n              <ListItemText primary=\"他的说话\" />\n              <Switch\n                edge=\"end\"\n                checked={voiceSettings.dialogue}\n                onChange={(e) => setVoiceSettings(prev => ({ ...prev, dialogue: e.target.checked }))}\n              />\n            </ListItem>\n            <ListItem sx={{ pl: 4 }}>\n              <ListItemText primary=\"他的心声\" />\n              <Switch\n                edge=\"end\"\n                checked={voiceSettings.thoughts}\n                onChange={(e) => setVoiceSettings(prev => ({ ...prev, thoughts: e.target.checked }))}\n              />\n            </ListItem>\n            <ListItem sx={{ pl: 4 }}>\n              <ListItemText primary=\"旁白\" />\n              <Switch\n                edge=\"end\"\n                checked={voiceSettings.narration}\n                onChange={(e) => setVoiceSettings(prev => ({ ...prev, narration: e.target.checked }))}\n              />\n            </ListItem>\n            <ListItem>\n              <ListItemIcon>\n                <MusicNoteIcon />\n              </ListItemIcon>\n              <ListItemText \n                primary=\"背景音乐音量\" \n                secondary={\n                  <Slider\n                    value={backgroundMusicVolume}\n                    onChange={handleVolumeChange}\n                    aria-labelledby=\"background-music-volume-slider\"\n                    sx={{ mt: 2 }}\n                  />\n                }\n              />\n            </ListItem>\n          </List>\n        </Menu>\n\n        {/* 背景图片选择对话框 */}\n        <Dialog\n          open={isBackgroundDialogOpen}\n          onClose={handleBackgroundDialogClose}\n          maxWidth=\"md\"\n          fullWidth\n        >\n          <DialogTitle>选择背景图片</DialogTitle>\n          <DialogContent>\n            <Grid container spacing={2} sx={{ mt: 1 }}>\n              {/* 这里可以添加背景图片选项 */}\n              <Grid item xs={4}>\n                <Paper\n                  sx={{\n                    height: 120,\n                    backgroundImage: 'url(/images/backgrounds/bg1.jpg)',\n                    backgroundSize: 'cover',\n                    cursor: 'pointer',\n                    '&:hover': {\n                      opacity: 0.8,\n                    },\n                  }}\n                  onClick={() => {\n                    // 处理背景图片选择\n                    handleBackgroundDialogClose();\n                  }}\n                />\n              </Grid>\n              {/* 可以添加更多背景图片选项 */}\n            </Grid>\n          </DialogContent>\n        </Dialog>\n\n        {/* 空白填充区域 */}\n        <Box sx={{ flex: 1 }} />\n\n        {/* 消息区域 */}\n        <Box\n          ref={messagesContainerRef}\n          sx={{\n            height: '50vh',\n            overflowY: 'auto',\n            overflowX: 'hidden',\n            '&::-webkit-scrollbar': {\n              display: 'none',\n            },\n            scrollbarWidth: 'none',\n            msOverflowStyle: 'none',\n            px: 2,\n            py: 1,\n          }}\n        >\n          {/* 消息列表 - 可收起 */}\n          <Collapse in={showMessages}>\n            <Box\n              sx={{\n                height: '100%',\n                overflow: 'auto',\n                display: 'flex',\n                flexDirection: 'column',\n                alignItems: 'flex-start',\n                px: 2,\n                py: 3,\n                gap: 3,\n              }}\n            >\n              {/* 角色简介卡片 */}\n              <Paper\n                sx={{\n                  p: 2,\n                  bgcolor: 'rgba(32, 32, 32, 0.75)',\n                  borderRadius: 2,\n                  backdropFilter: 'blur(10px)',\n                  width: '80%',\n                  maxWidth: '600px',\n                  position: 'relative',\n                }}\n              >\n                <Box \n                  sx={{ \n                    width: '95%',\n                    height: isIntroExpanded ? 'auto' : '4.8em',\n                    overflow: 'hidden',\n                    transition: 'height 0.3s ease',\n                  }}\n                >\n                  <Typography \n                    variant=\"body1\" \n                    sx={{ \n                      mb: 1,\n                      fontWeight: 'bold',\n                      color: 'text.primary',\n                    }}\n                  >\n                    简介\n                  </Typography>\n                  <Typography variant=\"body1\" sx={{ mb: 1 }}>\n                    {characterInfo.introduction}\n                  </Typography>\n                  <Box sx={{ display: 'flex', alignItems: 'center', gap: 1, color: 'text.secondary' }}>\n                    <MusicNoteIcon fontSize=\"small\" />\n                    <Typography variant=\"body2\" sx={{ fontStyle: 'italic' }}>\n                      {characterInfo.backgroundStory}\n                    </Typography>\n                  </Box>\n                </Box>\n                <IconButton \n                  size=\"small\"\n                  onClick={() => setIsIntroExpanded(!isIntroExpanded)}\n                  sx={{\n                    position: 'absolute',\n                    right: 8,\n                    bottom: 8,\n                    bgcolor: 'rgba(0, 0, 0, 0.2)',\n                    '&:hover': {\n                      bgcolor: 'rgba(0, 0, 0, 0.4)',\n                    },\n                  }}\n                >\n                  {isIntroExpanded ? <ExpandLessIcon /> : <ExpandMoreIcon />}\n                </IconButton>\n              </Paper>\n\n              {messages.map((message) => (\n                <Box\n                  key={message.id}\n                  sx={{\n                    display: 'flex',\n                    flexDirection: 'column',\n                    alignItems: message.sender === 'user' ? 'flex-end' : 'flex-start',\n                    width: '100%',\n                  }}\n                >\n                  <Box\n                    sx={{\n                      display: 'flex',\n                      alignItems: 'flex-end',\n                      gap: 1,\n                      ...(message.sender === 'user' \n                        ? {\n                            width: 'fit-content',\n                            maxWidth: {\n                              xs: '70%',\n                              sm: '65%',\n                            },\n                          }\n                        : {\n                            width: '80%',\n                            maxWidth: '600px',\n                          }\n                      ),\n                      ml: message.sender === 'user' ? 'auto' : 0,\n                      mr: message.sender === 'user' ? 0 : 'auto',\n                    }}\n                  >\n                    {message.sender === 'character' && (\n                      <Box sx={{ position: 'relative' }}>\n                        <IconButton\n                          size=\"small\"\n                          onClick={() => handlePlayVoice(message.id)}\n                          sx={{\n                            position: 'absolute',\n                            left: -40,\n                            bottom: 0,\n                            bgcolor: 'rgba(0, 0, 0, 0.2)',\n                            '&:hover': {\n                              bgcolor: 'rgba(0, 0, 0, 0.4)',\n                            },\n                          }}\n                        >\n                          <PlayArrowIcon fontSize=\"small\" />\n                          {isPlaying === message.id && (\n                            <Typography\n                              variant=\"caption\"\n                              sx={{\n                                position: 'absolute',\n                                left: -20,\n                                color: 'text.secondary',\n                              }}\n                            >\n                              3\"\n                            </Typography>\n                          )}\n                        </IconButton>\n                      </Box>\n                    )}\n                    <Paper\n                      sx={{\n                        p: 2,\n                        bgcolor: message.sender === 'user' ? 'rgba(245, 235, 224, 0.75)' : 'rgba(32, 32, 32, 0.75)',\n                        borderRadius: 2,\n                        backdropFilter: 'blur(10px)',\n                        boxShadow: '0 2px 12px rgba(0,0,0,0.1)',\n                        width: '100%',\n                        position: 'relative',\n                      }}\n                    >\n                      {message.sender === 'character' ? (\n                        <Box sx={{ position: 'relative' }}>\n                          {message.narration?.map((text, index) => (\n                            <Typography\n                              key={index}\n                              variant=\"body2\"\n                              sx={{\n                                color: 'text.secondary',\n                                fontSize: '0.85rem',\n                                mb: 1,\n                                width: '95%',\n                                textAlign: 'left',\n                              }}\n                            >\n                              {text}\n                            </Typography>\n                          ))}\n                          {message.dialogue && (\n                            <Typography\n                              variant=\"body1\"\n                              sx={{\n                                color: '#FFA500',\n                                mb: 1,\n                                width: '95%',\n                                textAlign: 'left',\n                              }}\n                            >\n                              \"{message.dialogue}\"\n                            </Typography>\n                          )}\n                          {message.thoughts && (\n                            <Typography\n                              variant=\"body1\"\n                              sx={{\n                                color: 'rgba(255, 255, 255, 0.6)',\n                                fontStyle: 'italic',\n                                mb: 1,\n                                width: '95%',\n                                textAlign: 'left',\n                              }}\n                            >\n                              ({message.thoughts})\n                            </Typography>\n                          )}\n                          <Box\n                            sx={{\n                              position: 'absolute',\n                              right: -48,\n                              top: '50%',\n                              transform: 'translateY(-50%)',\n                            }}\n                          >\n                            <IconButton\n                              size=\"small\"\n                              onClick={() => handlePlayVoice(message.id)}\n                              disabled={message.isVoiceLoading}\n                              sx={{\n                                bgcolor: 'rgba(32, 32, 32, 0.75)',\n                                backdropFilter: 'blur(10px)',\n                                '&:hover': {\n                                  bgcolor: 'rgba(32, 32, 32, 0.9)',\n                                },\n                              }}\n                            >\n                              {message.isVoiceLoading ? (\n                                <CircularProgress size={20} thickness={4} sx={{ color: 'rgba(255, 255, 255, 0.7)' }} />\n                              ) : (\n                                <VolumeUpIcon \n                                  fontSize=\"small\" \n                                  sx={{ \n                                    color: playingMessageId === message.id ? 'primary.main' : 'rgba(255, 255, 255, 0.7)'\n                                  }} \n                                />\n                              )}\n                            </IconButton>\n                          </Box>\n                        </Box>\n                      ) : (\n                        <Typography \n                          variant=\"body1\" \n                          sx={{\n                            color: '#333333',\n                            textAlign: 'left',\n                            width: '100%',\n                            minWidth: '4em',\n                          }}\n                        >\n                          {message.content}\n                        </Typography>\n                      )}\n                    </Paper>\n                  </Box>\n                </Box>\n              ))}\n              <div ref={messagesEndRef} />\n            </Box>\n          </Collapse>\n        </Box>\n\n        {/* 底部输入区域 */}\n        <Box\n          sx={{\n            p: 2,\n            width: '100%',\n            backdropFilter: 'blur(10px)',\n            bgcolor: 'rgba(0, 0, 0, 0.3)',\n            borderTop: '1px solid rgba(255, 255, 255, 0.1)',\n            position: 'relative',\n            zIndex: 1200,\n          }}\n        >\n          <Box\n            component=\"form\"\n            onSubmit={(e) => {\n              e.preventDefault();\n              handleSendMessage();\n            }}\n            sx={{\n              display: 'flex',\n              alignItems: 'center',\n              gap: 1,\n              bgcolor: 'rgba(32, 32, 32, 0.5)',\n              borderRadius: 2,\n              p: 1,\n            }}\n          >\n            <IconButton \n              sx={{ color: 'text.secondary' }}\n              onClick={() => {/* TODO: 实现语音通话功能 */}}\n            >\n              <CallIcon />\n            </IconButton>\n            <TextField\n              fullWidth\n              multiline\n              maxRows={4}\n              value={inputMessage}\n              onChange={(e) => setInputMessage(e.target.value)}\n              onKeyPress={handleKeyPress}\n              placeholder=\"发送消息给温柔总裁\"\n              variant=\"standard\"\n              sx={{\n                '& .MuiInputBase-root': {\n                  color: 'text.primary',\n                  '&::before, &::after': {\n                    display: 'none',\n                  },\n                },\n                '& .MuiInputBase-input': {\n                  p: 1,\n                },\n              }}\n            />\n            <IconButton \n              sx={{ color: 'text.secondary' }}\n              onClick={() => {/* TODO: 实现语音输入功能 */}}\n            >\n              <MicIcon />\n            </IconButton>\n            <IconButton \n              sx={{ color: 'text.secondary' }}\n              onClick={handleSendMessage}\n            >\n              <SendIcon />\n            </IconButton>\n          </Box>\n        </Box>\n      </Box>\n    </ThemeProvider>\n  );\n};\n\nexport default Chat; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}